<!DOCTYPE html>
<html>
<head>
    <title>Three.js Rotation Test</title>
    <style> body { margin: 0; } canvas { display: block; } </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/three@latest/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@latest/examples/js/loaders/GLTFLoader.js"></script>
    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        renderer.setClearColor(0xadd8e6);

        const loader = new THREE.GLTFLoader();

        let model;
        let isRotating = false;
        let previousTouchX = 0;
        let currentTouchX = 0;

        loader.load('models/bocolla/bocolla.gltf', (gltf) => {
            model = gltf.scene;
            scene.add(model);
            camera.position.z = 5;

            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            function animate() {
                requestAnimationFrame(animate);

                if (isRotating && model) {
                    const deltaX = currentTouchX - previousTouchX;
                    model.rotation.y += deltaX * 0.01;
                    previousTouchX = currentTouchX;
                }

                renderer.render(scene, camera);
            }

            animate();

        }, (xhr) => { }, (error) => {
            console.error('Error loading GLTF:', error);
        });

        document.addEventListener('touchstart', (event) => {
            console.log("touchstart", event);
            if (event.touches.length === 1 && model) {
                isRotating = true;
                currentTouchX = event.touches[0].clientX;
                previousTouchX = event.touches[0].clientX;
            }
        });

        document.addEventListener('touchmove', (event) => {
            console.log("touchmove", event);
            if (event.touches.length === 1 && isRotating) {
                currentTouchX = event.touches[0].clientX;
            }
        });

        document.addEventListener('touchend', (event) => {
            console.log("touchend", event);
            isRotating = false;
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>