<!DOCTYPE html>
<html>
<head>
<title>Camera Access</title>
<style>
  #video {
    width: 640px;
    height: 480px;
    object-fit: cover; /* Prevents distortion */
  }

  #canvas {
    display: none; /* Hidden by default */
  }
</style>
</head>
<body>

  <h1>Camera Access</h1>

  <video id="video" autoplay playsinline></video>
  <button id="snap">Take Photo</button>
  <canvas id="canvas"></canvas>  <img id="capturedImage" alt="Captured Image">  <script>
    const video = document.getElementById('video');
    const snapButton = document.getElementById('snap');
    const canvas = document.getElementById('canvas');
    const capturedImage = document.getElementById('capturedImage');
    let stream; // To store the video stream

    // Get user media (camera access)
    async function getCameraStream() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
      } catch (error) {
        console.error('Error accessing camera:', error);
        alert('Error accessing camera. Please make sure you have a camera and grant permissions.'); // User-friendly message
      }
    }


    getCameraStream(); // Call the function to start the camera


    snapButton.addEventListener('click', () => {
        if (stream) { // Check if the stream is available
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;  // Set canvas dimensions to video dimensions
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            // Convert the canvas content to a data URL (e.g., base64)
            const imageDataURL = canvas.toDataURL('image/png'); // You can change the format (e.g., 'image/jpeg')

            capturedImage.src = imageDataURL; // Set the image source
            capturedImage.style.display = 'block'; // Make the image visible
        }
    });


    // Optional: Stop the camera stream when the page is closed or unloaded.
    window.addEventListener('beforeunload', () => {
        if (stream) {
            stream.getTracks().forEach(track => track.stop());
        }
    });

  </script>

</body>
</html>